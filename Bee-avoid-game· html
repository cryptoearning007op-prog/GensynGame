<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Honeybee Avoid â€” 45s Game</title>
  <style>
    html,body{height:100%;margin:0;background:#000;display:flex;align-items:center;justify-content:center}
    canvas{background:#000;display:block;border:6px solid #111}
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .ui{position:absolute;top:10px;left:10px;color:#fff;font-family:system-ui,Arial}
    .modal{background:rgba(0,0,0,0.85);color:#fff;padding:18px;border-radius:10px;text-align:center;max-width:420px}
    .btn{display:inline-block;margin:8px;padding:8px 14px;border-radius:8px;background:#ffda6b;color:#000;font-weight:700;cursor:pointer;border:none}
    .level-btn{margin:6px;padding:8px 12px;border-radius:8px;background:#fff;color:#000;font-weight:700;cursor:pointer;border:none}
    .small{font-size:13px;color:#ddd}
  </style>
</head>
<body>
  <canvas id="c" width="800" height="600"></canvas>
  <div class="overlay" id="overlay">
    <div class="modal" id="menu">
      <div style="display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:10px">
        <img id="manImg" src="man.png" alt="man" style="width:110px;height:110px;object-fit:contain;border-radius:8px;background:#fff"/>
        <div style="text-align:left">
          <h2 style="margin:0 0 6px 0">Hello!</h2>
          <div class="small">I'm here to cheer you on. Choose a level and press Start.</div>
        </div>
      </div>
      <div style="margin-top:6px">
        <div style="margin-bottom:8px">Pick a level (this choice appears only once before starting):</div>
        <div>
          <button class="level-btn" id="easyBtn">Easy</button>
          <button class="level-btn" id="hardBtn">Hard</button>
        </div>
        <div style="margin-top:12px">
          <button id="startBtn" class="btn">Start Game</button>
        </div>
        <div class="small" style="margin-top:8px">Goal: Survive 45 seconds without touching the pink logos. Tap/click to make the bee jump.</div>
      </div>
    </div>
  </div>
  <div class="ui" id="ui">
    <div id="time">Time: 45</div>
    <div id="level" style="margin-top:6px">Level: -</div>
    <div id="status" style="margin-top:6px;color:#ffb6b6"></div>
  </div>

<script>
// -----------------------------------------
// Configuration & assets
// -----------------------------------------
const CANVAS = document.getElementById('c');
const ctx = CANVAS.getContext('2d');
let W = CANVAS.width, H = CANVAS.height;

// Images: the game expects two files next to the HTML file:
//  - logo.png (the pink pixel logo used as obstacle block)
//  - man.png  (the "man" image shown before starting)
// Please put your provided images in the same folder and name them as above.

const logoImg = new Image(); logoImg.src = 'logo.png';
const manImg = document.getElementById('manImg'); // also loaded in the DOM

// Bee appearance (we draw it with canvas), but you can replace with a sprite if you like.

// Game state
let level = null; // 'easy' | 'hard'
let started = false;
let paused = false;
let timeLeft = 45; // seconds
let lastTime = null;
let obstacles = [];
let spawnTimer = 0;
let score = 0;
let gameOver = false;
let win = false;

// Bee physics
const bee = { x:120, y:H/2, vy:0, radius:18, gravity:0.9, jump:-14 };

// Level params (will be set when player picks easy/hard)
const params = {
  easy: { gap: 180, speed: 160, spawnInterval: 1400 },
  hard: { gap: 120, speed: 220, spawnInterval: 950 }
};
let curParams = params.easy;

// Touch / click control
function jump(){
  if(!started) return;
  if(gameOver) return;
  bee.vy = curParams ? bee.jump : -12;
}

CANVAS.addEventListener('mousedown', jump);
CANVAS.addEventListener('touchstart', (e)=>{ e.preventDefault(); jump(); }, {passive:false});
window.addEventListener('keydown', (e)=>{ if(e.code==='Space') jump(); });

// Menu buttons
const overlay = document.getElementById('overlay');
const menu = document.getElementById('menu');
const startBtn = document.getElementById('startBtn');
const easyBtn = document.getElementById('easyBtn');
const hardBtn = document.getElementById('hardBtn');
const levelText = document.getElementById('level');
const timeText = document.getElementById('time');
const statusText = document.getElementById('status');

easyBtn.onclick = ()=>{ level='easy'; curParams = params.easy; easyBtn.style.background='#ffeaa7'; hardBtn.style.background='#fff'; levelText.textContent='Level: Easy'; };
hardBtn.onclick = ()=>{ level='hard'; curParams = params.hard; hardBtn.style.background='#ffeaa7'; easyBtn.style.background='#fff'; levelText.textContent='Level: Hard'; };

startBtn.onclick = ()=>{
  if(!level) { alert('Please choose Easy or Hard first.'); return; }
  startGame();
};

function startGame(){
  started = true; overlay.style.display='none';
  timeLeft = 45; lastTime = performance.now(); obstacles=[]; spawnTimer=0; gameOver=false; win=false; bee.y = H/2; bee.vy=0; score=0;
  requestAnimationFrame(loop);
}

// Obstacle generator: creates a vertical column of 'logo' blocks with a gap at random vertical position
function spawnObstacle(){
  const gap = curParams.gap;
  const minY = 60; const maxY = H - 60 - gap;
  const gapY = Math.floor(Math.random()*(maxY-minY+1))+minY;
  obstacles.push({ x: W + 40, gapY, gap, width: 60 });
}

// Collision check: check bee circle against tiled logo rectangles forming columns
function checkCollision(obs){
  // We'll split the column into rectangular blocks (logo image height ~48). But to simplify: the column is solid except for the gap.
  const left = obs.x - obs.width/2;
  const right = obs.x + obs.width/2;
  if(bee.x + bee.radius < left || bee.x - bee.radius > right) return false;
  // vertically, collision if bee intersects top part or bottom part
  const topBottom = (bee.y - bee.radius) < obs.gapY || (bee.y + bee.radius) > (obs.gapY + obs.gap);
  return topBottom;
}

// Draw helper: draw obstacle column using logo tiles
function drawObstacle(obs){
  const tileW = 40; const tileH = 40;
  const colX = obs.x - obs.width/2;
  // top column from y=0 to obs.gapY
  for(let y=0;y<obs.gapY;y+=tileH){
    ctx.drawImage(logoImg, colX, y, obs.width, tileH);
  }
  // bottom column from gapY+gap to H
  for(let y=obs.gapY+obs.gap;y<H;y+=tileH){
    ctx.drawImage(logoImg, colX, y, obs.width, tileH);
  }
}

// Main loop
function loop(ts){
  if(!lastTime) lastTime = ts;
  const dt = Math.min(40, ts - lastTime); // ms
  lastTime = ts;
  if(!started) return;
  if(gameOver) { draw(); displayEnd(); return; }

  // update time
  timeLeft -= dt/1000;
  if(timeLeft <= 0){ timeLeft = 0; win = true; gameOver = true; }

  // spawn obstacles
  spawnTimer += dt;
  if(spawnTimer > curParams.spawnInterval){ spawnTimer = 0; spawnObstacle(); }

  // move obstacles
  for(let i=obstacles.length-1;i>=0;i--){
    obstacles[i].x -= curParams.speed * (dt/1000);
    if(obstacles[i].x < -100) obstacles.splice(i,1);
  }

  // physics
  bee.vy += bee.gravity;
  bee.y += bee.vy;
  // ground/ceiling
  if(bee.y + bee.radius > H){ bee.y = H - bee.radius; bee.vy = 0; gameOver=true; }
  if(bee.y - bee.radius < 0){ bee.y = bee.radius; bee.vy = 0; }

  // collision check
  for(const ob of obstacles){ if(checkCollision(ob)){ gameOver=true; break; } }

  draw();
  if(!gameOver) requestAnimationFrame(loop);
}

// Draw everything
function draw(){
  ctx.clearRect(0,0,W,H);
  // background
  ctx.fillStyle = '#000'; ctx.fillRect(0,0,W,H);

  // finish line indicator at far right (just visual; win is based on timer)
  ctx.fillStyle = '#0f0'; ctx.fillRect(W-10,0,6,H);

  // obstacles
  for(const ob of obstacles){ drawObstacle(ob); }

  // draw bee
  // body
  ctx.save();
  ctx.translate(bee.x, bee.y);
  ctx.beginPath(); ctx.ellipse(0,0,bee.radius,bee.radius*0.8,0,0,Math.PI*2);
  ctx.fillStyle = '#ffd24d'; ctx.fill();
  // stripes
  ctx.fillStyle = '#222'; ctx.fillRect(-10,-8,20,6);
  // wing
  ctx.beginPath(); ctx.ellipse(6,-18,10,6,0,0,Math.PI*2); ctx.fillStyle='rgba(255,255,255,0.9)'; ctx.fill();
  ctx.restore();

  // UI text
  timeText.textContent = 'Time: ' + Math.ceil(timeLeft);
  statusText.textContent = '';
}

function displayEnd(){
  // dark overlay and message
  ctx.fillStyle = 'rgba(0,0,0,0.6)'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle = '#fff'; ctx.textAlign='center'; ctx.font='28px system-ui';
  if(win){ ctx.fillText('You survived 45s â€” You win! ðŸŽ‰', W/2, H/2 - 6); }
  else{ ctx.fillText('Game Over â€” You hit a logo', W/2, H/2 - 6); }
  ctx.font='16px system-ui'; ctx.fillText('Tap to play again', W/2, H/2 + 30);
}

// restart on tap after game over
CANVAS.addEventListener('mousedown', (e)=>{ if(gameOver){ overlay.style.display='flex'; menu.style.display='block'; started=false; } });
CANVAS.addEventListener('touchstart', (e)=>{ if(gameOver){ overlay.style.display='flex'; menu.style.display='block'; started=false; } }, {passive:false});

// make canvas responsive
function resize(){
  // keep fixed internal resolution but scale CSS
  const maxW = Math.min(window.innerWidth - 20, 900);
  const scale = Math.min(maxW / 800, (window.innerHeight - 60) / 600);
  CANVAS.style.width = Math.round(800*scale)+'px';
  CANVAS.style.height = Math.round(600*scale)+'px';
}
window.addEventListener('resize', resize); resize();

// preload images and show menu once ready
let assetsLoaded = 0;
logoImg.onload = ()=>{ assetsLoaded++; };
logoImg.onerror = ()=>{ /* still continue, will draw simple rects if not loaded */ };
manImg.onload = ()=>{ assetsLoaded++; };
manImg.onerror = ()=>{ /* ignore */ };

// Draw an initial placeholder scene while waiting
(function initialDraw(){
  ctx.fillStyle='#000'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle='#fff'; ctx.font='20px system-ui'; ctx.textAlign='center';
  ctx.fillText('Honeybee Avoid â€” ready', W/2, H/2 - 10);
  ctx.fillText('Place logo.png and man.png next to this file, choose level and Start', W/2, H/2 + 20);
})();

</script>
</body>
</html>
